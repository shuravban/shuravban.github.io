---
layout: post
title:  Разминка по новому
date:   2017-08-12 22:47:37 +06
tags:   twitter twurl t
---

У меня есть аккаунт на твиттере, которым я не пользовался уже почти три года. За это время накопилось много твитов, от какого-то там сервиса на который я подписался. Задача - скачать твиты, выявить бяку и удалить твиты.

Скачиваем с помощью `t`. `t timeline` дает текущую ленту активного
пользователя. `t set active SCREEN_NAME` дает нам нужного пользователя
(естественно после всех танцев с бубном по авторизации). Интересно, но для моей
задачи, похоже переавторизовываться было не надо. `t timeline SCREEN_NAME`
с соответствующим дает 3600 (или 3200) последних твитов любого пользователя.
Интересно, что `t timeline` и `t timeline NAME` - два совершенно разных метода
в `twitter API`. Объясняется это, конечно, как и любые несуразицы в программах,
"историческими" причинами.

После выборки идэшек нужных твитов (примитивнейшая задача для Linux) 
используем `twurl`:

    twurl -X POST /1.1/statuses/destroy/$ID.json

Явное указание POST-метода, обязательное окончание .json, и абсолютно никакой индикации ошибок. Можно трассировать полностью HTTP запрос и ответ с помощью опции `-t`.

Цикл на шелл и задача решена.

Заметки об авторизации
=======================

И `t`, и `twurl` предлагают какую-то замысловатую и глючную систему авторизации, которая абсолютно не нужна. В любом случае надо идти на сайт твиттера, регистрировать приложения, изменять уровень доступа и выбирать ключи пользователя. Там же нужно брать и ключи доступа, которые данные утилитки пытаются получить замысловатым способом.

Ключи хранятся в файлах `.trc` и `.twurlrc`,  в абсолютно одинаковом формате:

```

configuration:
  default_profile:
  - YOUR_USER_NAME
  - YOUR_CONSUMER_KEY
profiles:
  YOUR_USER_NAME:
    YOUR_CONSUMER_KEY:
      username: YOUR_USER_NAME
      consumer_key: YOUR_CONSUMER_KEY
      consumer_secret: YOUR_CONSUMER_SECRET
      token: YOUR_ACCESS_TOKEN
      secret: YOUR_ACCESS_TOKEN_SECRET

```

Проще создать файл вручную. А потом скопировать и переименовать.

Ну все. Теперь точно все. Наверное.
